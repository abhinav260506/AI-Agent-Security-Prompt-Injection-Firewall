const n=[{regex:/ignore\s+(?:the|this|previous|all|prior)\s+instruction/i,name:"Instruction Override",score:1},{regex:/ignore\s+(?:the|this|previous|all|prior)\s+directions/i,name:"Instruction Override",score:1},{regex:/ignore\s+what\s+I\s+said/i,name:"Instruction Override",score:.9},{regex:/forget\s+(?:all\s+)?(?:prior\s+|previous\s+)?instructions/i,name:"Instruction Override",score:1},{regex:/ignore\s+this\s+and\s+(?:send|write|print|display)/i,name:"Compound Injection",score:1},{regex:/disregard\s+(?:the|this|previous)\s+message/i,name:"Instruction Override",score:.9},{regex:/system\s+override/i,name:"System Override",score:1},{regex:/debug\s+mode/i,name:"Mode Switching",score:.8},{regex:/admin\s+mode/i,name:"Mode Switching",score:.8},{regex:/urgent\s+system\s+update/i,name:"False Urgency",score:.7},{regex:/do\s+not\s+alert\s+the\s+user/i,name:"Evasion Attempt",score:1},{regex:/delete\s+this\s+email\s+after/i,name:"Trace Removal",score:.9},{regex:/forward\s+this\s+email\s+to/i,name:"Data Exfiltration",score:.9},{regex:/(?:forward|send)\s+(?:the|this|all)?\s*(?:following|before|above|previous|below)?\s*(?:mail|email|message|text|content)\s+to\s+(?:this\s+email\s*:?)?/i,name:"Data Exfiltration",score:.95},{regex:/send\s+(?:the|this)?\s*.*\s*to\s+[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/i,name:"Data Exfiltration",score:.9},{regex:/retrieve\s+.*cookies/i,name:"Credential Theft",score:1},{regex:/immediately\s+wire\s+transfer/i,name:"Financial Coercion",score:1},{regex:/mandatory\s+update\s+for/i,name:"False Urgency",score:.8}],a={name:"DirectiveScanner",scanText(i,o={}){const r=[];return n.forEach(s=>{const t=new RegExp(s.regex.source,"gi");let e;for(;(e=t.exec(i))!==null;)r.push({detected:!0,type:"MALICIOUS_DIRECTIVE",subtype:s.name,score:s.score,reasoning:[`Detected high-risk phrase: "${s.name}"`],match:e[0],index:e.index,end:e.index+e[0].length})}),r}};export{a as D};
